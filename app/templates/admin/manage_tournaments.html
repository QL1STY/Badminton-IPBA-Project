{% extends "base.html" %}
{% block content %}
<div class="container mx-auto py-12 px-4 sm:px-6 lg:px-8">
    <div class="sm:flex sm:items-center">
        <div class="sm:flex-auto">
            <h2 class="text-2xl font-bold text-gray-900">{{ _('Zarządzaj Turniejami') }}</h2>
        </div>
        <div class="mt-4 sm:mt-0 sm:ml-16 sm:flex-none">
            <a href="{{ url_for('new_tournament') }}" class="inline-flex items-center justify-center rounded-md border border-transparent bg-[var(--c-brand-primary)] px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-[var(--c-brand-primary)]/90">{{ _('Dodaj Turniej') }}</a>
        </div>
    </div>
    <div class="mt-8 flow-root">
        <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
            <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg">
                    <table class="min-w-full divide-y divide-gray-300">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">ID</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">{{ _('Tytuł') }}</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">{{ _('Data Rozpoczęcia') }}</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">{{ _('Uczestnicy') }}</th>
                                <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6"><span class="sr-only">Akcje</span></th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 bg-white">
                            {% for tournament in tournaments %}
                            <tr>
                                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6">{{ tournament.id }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ tournament.title }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ tournament.start_date.strftime('%Y-%m-%d') }}</td>
                                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">{{ tournament.registrations.count() }} / {{ tournament.max_players }}</td>
                                <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                    <a href="{{ url_for('tournament_details', tournament_id=tournament.id) }}" class="text-gray-500 hover:text-gray-700" title="{{ _('Zobacz') }}"><i class="fa-solid fa-eye"></i></a>
                                    <a href="{{ url_for('admin_manage_winners', tournament_id=tournament.id) }}" class="ml-4 text-green-600 hover:text-green-900" title="{{ _('Zarządzaj Zwyciezcami') }}"><i class="fa-solid fa-trophy"></i></a>
                                    <a href="{{ url_for('admin_update_tournament', tournament_id=tournament.id) }}" class="ml-4 text-indigo-600 hover:text-indigo-900" title="{{ _('Edytuj') }}"><i class="fa-solid fa-pen-to-square"></i></a>
                                    <button type="button" class="ml-4 text-red-600 hover:text-red-900" title="{{ _('Delete') }}" data-bs-toggle="modal" data-bs-target="#deleteModal-{{ tournament.id }}"><i class="fa-solid fa-trash-can"></i></button>
                                </td>
                            </tr>
                            <div class="modal fade" id="deleteModal-{{ tournament.id }}" tabindex="-1" aria-labelledby="deleteModalLabel-{{ tournament.id }}" aria-hidden="true">
                              <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="deleteModalLabel-{{ tournament.id }}">{{ _('Potwierdź Usunięcie') }}</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
                                  <div class="modal-body">
                                    <p>{{ _('Czy na pewno chcesz usunąć ten turniej?') }} "{{ tournament.title }}"? {{ _('Tej akcji nie można cofnąć') }}</p>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ _('Anuluj') }}</button>
                                    <form  action="{{ url_for('admin_delete_tournament', tournament_id=tournament.id) }}" method="POST">
                                        {{ delete_form.hidden_tag() }}
                                        <button type="submit" class="btn btn-danger">{{ _('Usuń') }}</button>
                                    </form>
                                  </div>
                                </div>
                              </div>
                            </div>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
{{ super() if super }}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}